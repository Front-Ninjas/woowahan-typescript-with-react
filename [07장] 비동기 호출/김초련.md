#API 요청
#fetch로 API 요청하기
외부 데이터베이스에 접근해서 사용자가 장바구니에 추가한 정보를 호출하는 코드를 작성하는데 fetch 함수를 사용해서 배지로 보이게 함

배지란?
UI에 표시되는 작은 원형이나 사각형 형태의 요소.
주로 다른 요소의 옆이나 아이콘 위에 위치해 사용자에게 새로운 것이 있음을 알려주는 것.

장바구니 정보를 비동기 함수인 fetch로 불러와 장바구니 내부를 확인하여 물품의 개수를 배지 아이콘으로 보여주는 기능
백엔드에서 기능 변경을 해서 API URL을 수정해야 한다
여러 서버에 API 요청할 떄 새로운 API 요청 정책이 추가될 때마다 계속해서 비동기 호출 코드를 수정해야 하는 번거로움 존재

#서비스 레이어로 분리하기
여러 API 요청 정책이 추가되어 코드가 변경될 수 있다는 점을 감안하면, 비동기 호출 코드는 컴포넌트 영역에서 분리되어 다른 영역(서비스 레이어)에서 처리되어야 함
단순히 fetch 함수를 분리하는 것만으로 API 요청 정책이 추가되는 것을 해결하기 어려움
EX) fetch 함수에서 타임아웃을 설정하기 위해서는 다음과 같이 구현해야 함
또한 쿼리 매개변수나 커스텀 헤더 추가 또는 쿠키를 읽어 토큰을 집어넣는 등 다양한 API 정책이 추가될 수 있는데 이를 모두 구현하는 것은 번거로운 일.

#Axios 활용하기
fetch는 내장 라이브러리이기 때문에 따로 임포트하거나 설치할 필요 없이 사용할 수 있다
많은 기능을 사용하려면 직접 구현해서 사용해야 한다 -> 이런 번거로움 때문에 fetch 함수를 직접 쓰는 대신 Axios 라이브러리를 사용하고 있다

#Axios 인터셉터 사용하기
각각의 requester는 서로 다른 역할을 담당하는 다른 서비이기 때문에 requester별로 다른 헤더를 설정해줘야 하는 로직이 필요할 수도 있다
인터셉터 기능을 사용하여 requester에 따라 비동기 호출 내용을 추가해서 처리할 수 있다 또한 API 에러를 처리할 때 하나의 에러 객체로 묶어서 처리할 수도 있다

요청 옵션에 따라 다른 인터셉터를 만들기 위해 빌더 패턴을 추가하여 APIBuilde같은 클래스 형태로 구성하기도 한다

빌더 패턴이란?
객체 생성을 더 편리하고 가독성있게 만들기 위한 디자인 패턴 중 하나. 주로 복잡한 객체의 생성을 단순화하고 객체 생성 과정을 분리하여 객체를 조립하는 방법을 제공.
기본 API 클래스로 실제 호출 부분을 구성, 위와 같은 API 호출을 하기 위한 래퍼런스를 빌더 패턴으로 만든다

APIBuiler 클래스는 보일러플레이트 코드가 많다는 단점이 있음
하지만 옵션이 다양한 경우에 인터셉터를 설정값에 따라 적용하고, 필요 없는 인터셉터를 선택적으로 사용할 수 있다는 장점도 있음

보일러플레이트 코드란?
어떤 기능을 사용할 때 반복적으로 사용되는 기본적인 코드를 말한다. 예를 들어 API를 호출하기 위한 기본적인 설정과 인터셉터 등을 설정하는 부분을 보일러플레이트 코드로 간주할 수 있음

#API 응답 타입 지정하기
같은 서버에서 오는 응답의 형태는 대체로 통일되어 있어서 앞서 소개한 API의 응답 값은 하나의 Response 타입으로 묶일 수 있다
이와 같이 서버에서 오는 응답을 통일해줄 때 주의할 점이 있다

#뷰 모델 사용하기
API 응답은 변할 가능성이 크다.
특히 새로운 프로젝트는 서버 스펙이 자주 바뀌기 때문에 뷰모델을 사용하여 API 변경에 따른 범위를 한정해줘야 한다
해당 API를 사용할 때는 다음처럼 사용한다. 이 예시에서는 컴포넌트 내부에서 비동기 함수를 호출하고 then으로 처리하고 있지만, 실제 비동기 함수는 컴포넌트 내부에서 직접 호출되지 않음

흔히 좋은 컴포넌트는 변경될 이유가 하나뿐인 컴포넌트라고 말한다
API 응답의 items 인자를 좀 더 정확한 개념으로 나타나기 위해 jobItems나 carItems 같은 이름으로 수정하면 해당 컴포넌트도 수정해야 한다

#Superstruct를 사용해 런타임에서 응답 타입 검증하기
런타임 응답 타임 검증을 하기 위해 사용하는 Superstruct 라이브러리의 소개는 아래와 같다
-Superstruct를 사용하여 인터페이스 정의와 자바스크립트 데이터의 유효성 검사를 쉽게 할 수 있다
-Superstruct는 런타임에서의 데이터 유효성 검사를 통해 개발자와 사용자에게 자세한 런타임 에러를 보여주기 위해 고안됨

#실제 API 응답 시의 Superstruct 활용 사례








